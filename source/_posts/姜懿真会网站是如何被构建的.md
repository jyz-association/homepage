---
title: "姜懿真会网站是如何被构建的"
date: 2020-02-25 09:00:48
tags: 技术指南
category: guidelines
thumbnail: https://pic.downk.cc/item/5e5490646127cc071394d81a.png
---

这篇文章将会介绍如何构建像姜懿真会官网这样的网站.

<!--more-->

# 开始

姜懿真会的官网使用[hexo](https://hexo.io/)博客框架和[icarus](https://ppoffice.github.io/hexo-theme-icarus)主题构建.

# 安装hexo

安装hexo之前, 需要先安装git, nodejs和npm. 由于某些特殊原因, 在中国大陆建议使用淘宝npm源下载hexo: 

```
npm install hexo -g
```

或者在中国大陆: 

```
npm install hexo -g --registry=https://registry.npm.taobao.org
```

在使用之前, 请先配置好git. 关于配置git的方法可以参考[git官网](https://git-scm.com).

# 创建工作目录

新建一个目录, 然后运行: 

```
hexo init
```

这一命令会从GitHub上克隆`hexo-start`仓库, 并把`landscape`主题克隆到工作目录下的`themes/`目录. 

由于中国大陆的某些特殊原因, 从GitHub克隆仓库可能很慢, 建议魔法上网.

安装hexo的git部署工具:

```
npm install hexo-deployer-git
```

在工作目录初始化完成之后, 请运行: 

```
npm install
```

来安装所有依赖模块. (在中国大陆建议使用淘宝npm源.)

# 安装主题

姜懿真会网站使用[icarus](https://ppoffice.github.io/hexo-theme-icarus)主题. 

把主题的仓库clone到`themes/`目录下. 

```
git clone https://ppoffice.github.io/hexo-theme-icarus.git ./themes/icarus/
```

将`_config.yml`中的themes项修改为`icarus`. 

# 建站与购买域名

姜懿真会的网站在GitHub Pages上托管. 

如果你不使用GitHub, 许多其他的git托管平台(比如: gitee)也提供类似服务.

首先, 需要在GitHub上新建一个仓库. 在博客中新建一篇文章, 生成静态文件然后部署到git仓库(关于生成与部署会在下方讲到). 进入GitHub中仓库的设置界面, 将`GitHub Page -> Source`选项设为gh-pages分支. 保存设置后, 如果看见: `Your site is published at https://***.github.io/***`, 则证明部署成功.

接下来, 我们需要购买一个域名. 我们可以从[GoDaddy](https://sg.godaddy.com/zh)或者[万网](https://wanwang.aliyun.com)购买域名. 由于万网在中国大陆, 需要对一些域名进行备案, 所以建议在GoDaddy购买. 

购买完域名后, 进入管理控制台修改DNS. 新建一个CNAME记录, 主机名设为`@`或者`www`, 记录值设为`https://***.github.io`(将***替换为你的GitHub用户名), 保存设置.  

# 配置

回到工作目录下.

在`./_config.yml`中包含hexo博客的配置项, 在`./themes/path-to-theme/_config.yml`中包含对应主题的配置项. 关于配置项的用法, 请参考hexo官网和对应主题的文档. 

icarus主题包含对valine和Google Analytics的支持. valine是一个基于LeanCloud的评论系统, Google Analytics是谷歌的网络分析工具. 更多信息可以参考[valine官网](https://valine.js.org/)和[Google Analytics官网(需要魔法上网)](https://analytics.google.com/)

# 发布文章与部署

创建一个新文章:

```
hexo new post ***
```

会在`./source/_posts`创建`***.md`.

生成静态文件:

```
hexo generate
```

在本地服务器上预览博客:

```
hexo server
```

访问`http://localhost:4000`即可预览博客网站.

在`./source/`下创建一个`CNAME`文件, 填入之前购买的域名, 例如:

```
echo www.jyzh.de > ./source/CNAME
```

在`./_config.yml`中将`deployment`选项设为如下值:

```yaml
type: 'git'
repo: git@git.hosting/path-to-your-repo.git
brunch: gh-pages
```

将git仓库uri设为你的仓库uri. 保存配置.

部署:

```
hexo deploy
```

如果以上配置正确, 那么访问`http://your.domain/`就能看到网站.

以上（